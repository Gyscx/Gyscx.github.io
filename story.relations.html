<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>剧情-主要角色关系图 | Shadow Fight 3 中文 Wiki</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>

<body class="theme-legion"><!-- 可选：派系主题 -->

    <!-- 登录模态框 -->
    <div id="loginModal" class="login-modal" style="display: none;">
        <div class="login-box">
            <h2>请先登录</h2>
            <p>您需要登录才能访问此页面</p>

            <div class="input-group">
                <label for="loginUsername">用户名</label>
                <input type="text" id="loginUsername" placeholder="请输入用户名">
            </div>

            <div class="input-group">
                <label for="loginPassword">密码</label>
                <input type="password" id="loginPassword" placeholder="请输入密码">
            </div>

            <div class="login-buttons">
                <button id="performLogin" class="login-btn">登录</button>
                <button id="goToRegister" class="register-btn">注册账号</button>
            </div>
        </div>
    </div>
    <header class="top">
        <div class="logo"><img src="./Logo.png" alt="暗影格斗3" height="50"> </div>
        <nav>
            <a href="index.html">首页</a>
            <a href="factions.html">派系</a>
            <a href="guides.html">攻略</a>
            <a href="codex.html">图鉴</a>
            <a href="story.html">剧情</a>
            <a href="http://192.168.1.10:3000/login.html" class="login_display" id="loginDisplay"><span
                    style="color: red;">登录</span></a>
        </nav>

        <!-- 用户信息区域 -->
        <div class="user-info" id="userInfo" style="display: none;">
            欢迎， <span id="usernameDisplay"></span>
            <button id="logoutBtn" class="logout-btn">退出登录</button>
        </div>
    </header>

    <main class="container">

        <!-- Breadcrumb -->
        <nav class="breadcrumb">
            <a href="index.html">首页</a><span class="sep">›</span>
            <a href="story.html">剧情</a><span class="sep">›</span>
            主要角色关系图
        </nav>

        <!-- 页面内容从这里开始 -->
        <section class="hero">
            <h1>主要角色关系图</h1>
            <p>
                本页面从立场与动机角度整理暗影格斗 3 中主要角色之间的关系。
                关系并非绝对善恶，而是随着剧情推进不断变化。
            </p>
        </section>

        <div class="legend">
            <div class="legend-item"><span class="dot legion"></span> 军团阵营</div>
            <div class="legend-item"><span class="dot dynasty"></span> 王朝阵营</div>
            <div class="legend-item"><span class="dot herald"></span> 先锋阵营</div>
        </div>

        <section class="relations">
            <div class="card">
                <h3>影子（Shadow）</h3>
                <div class="relation"><strong><a href="character_June.html"
                            style="color:inherit;text-decoration:none">June</a></strong> <span class="type trust">信任 /
                        引导</span></div>
                <div class="relation"><strong><a href="character_Bolo.html"
                            style="color:inherit;text-decoration:none">Bolo</a></strong> <span class="type utilize">利用 /
                        观察</span>
                </div>
                <div class="relation"><strong><a href="character_军团高层.html"
                            style="color:inherit;text-decoration:none">军团高层</a></strong> <span class="type hostile">敌对 /
                        监控</span>
                </div>
            </div>

            <div class="card">
                <h3>Bolo</h3>
                <div class="relation"><strong><a href="character_影子.html"
                            style="color:inherit;text-decoration:none">影子</a></strong> <span
                        class="type utilize">实验对象</span></div>
                <div class="relation"><strong><a href="character_先锋派系.html"
                            style="color:inherit;text-decoration:none">先锋派系</a></strong> <span
                        class="type trust">核心支持</span></div>
            </div>

            <div class="card">
                <h3>June</h3>
                <div class="relation"><strong><a href="character_影子.html"
                            style="color:inherit;text-decoration:none">影子</a></strong> <span class="type trust">信任 /
                        协助</span></div>
                <div class="relation"><strong><a href="character_军团.html"
                            style="color:inherit;text-decoration:none">军团</a></strong> <span
                        class="type hostile">理念冲突</span></div>
            </div>
        </section>
        <section class="section" style="margin-top:48px">
            <h3>相关人物</h3>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:12px">
                <a href="character_Bolo.html" style="text-decoration:none;color:inherit">
                    <div style="background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:14px">
                        <strong>Bolo</strong>
                        <div style="font-size:13px;color:var(--muted);margin-top:4px">先锋 · 利用 / 实验</div>
                    </div>
                </a>
                <a href="character_June.html" style="text-decoration:none;color:inherit">
                    <div style="background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:14px">
                        <strong>June</strong>
                        <div style="font-size:13px;color:var(--muted);margin-top:4px">军团 · 信任 / 引导</div>
                    </div>
                </a>
                <a href="factions.html" style="text-decoration:none;color:inherit">
                    <div style="background:var(--panel);border:1px solid #1f2937;border-radius:14px;padding:14px">
                        <strong>三大派系</strong>
                        <div style="font-size:13px;color:var(--muted);margin-top:4px">军团 / 王朝 / 先锋</div>
                    </div>
                </a>
            </div>
        </section>
    </main>

    <footer>
        本站为 Shadow Fight 3 非官方中文 Wiki，与 Nekki/万达院线游戏(互爱互动) 无隶属关系。
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // DOM元素
            const loginModal = document.getElementById('loginModal');
            const userInfo = document.getElementById('userInfo');
            const usernameDisplay = document.getElementById('usernameDisplay');
            const logoutBtn = document.getElementById('logoutBtn');
            const performLogin = document.getElementById('performLogin');
            const goToRegister = document.getElementById('goToRegister');
            const voteSystemLink = document.getElementById('voteSystemLink');
            const messageBoardLink = document.getElementById('messageBoardLink');

            const loginDisplay = document.getElementById('loginDisplay');

            // 检查登录状态
            function checkLoginStatus() {
                const token = localStorage.getItem('token');
                const username = localStorage.getItem('username');

                if (token && username) {
                    // 已登录
                    usernameDisplay.textContent = username;
                    userInfo.style.display = 'flex';
                    loginModal.style.display = 'none';
                    loginDisplay.style.display = 'none';
                } else {
                    // 未登录
                    userInfo.style.display = 'none';
                    loginDisplay.style.display = 'inline';
                }
            }

            // 模拟登录函数
            function login(username, password) {
                // 模拟API调用
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        // 简单验证 - 实际项目中应调用真实API
                        if (username && password) {
                            resolve({
                                token: 'mock_token_' + Date.now(),
                                username: username,
                                role: 'user'
                            });
                        } else {
                            reject(new Error('用户名或密码不能为空'));
                        }
                    }, 1000);
                });
            }

            // 登录按钮点击事件
            performLogin.addEventListener('click', async function () {
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;

                if (!username || !password) {
                    alert('请输入用户名和密码');
                    return;
                }

                // 显示加载状态
                performLogin.textContent = '登录中...';
                performLogin.disabled = true;

                try {
                    const result = await login(username, password);

                    // 保存登录信息
                    localStorage.setItem('token', result.token);
                    localStorage.setItem('username', result.username);
                    localStorage.setItem('role', result.role);

                    // 更新UI
                    checkLoginStatus();

                    // 获取目标页面并跳转
                    const targetPage = localStorage.getItem('targetPage');
                    if (targetPage) {
                        // 清除存储的目标页面
                        localStorage.removeItem('targetPage');
                        window.location.href = targetPage;
                    } else {
                        // 默认跳转到首页
                        window.location.href = 'index.html';
                    }
                } catch (error) {
                    alert('登录失败: ' + error.message);
                    performLogin.textContent = '登录';
                    performLogin.disabled = false;
                }
            });

            // 注册按钮点击事件
            goToRegister.addEventListener('click', function () {
                window.location.href = 'register.html';
            });

            // 退出登录
            logoutBtn.addEventListener('click', function () {
                if (confirm('确定要退出登录吗？')) {
                    localStorage.removeItem('token');
                    localStorage.removeItem('username');
                    localStorage.removeItem('role');
                    checkLoginStatus();
                }
            })

            // 页面加载时检查登录状态
            checkLoginStatus();

        });
    </script>
</body>

</html>